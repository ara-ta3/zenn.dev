---
title: "AppleScriptã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ã‚’å¤‰æ›´ã™ã‚‹"
emoji: "ğŸ—‚"
type: "tech"
topics: ["AppleScript"]
published: false
---

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ã‚’ä»•äº‹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã§åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒç™ºç”Ÿã—ãŸã®ã§ã€Script ã§å‡ºæ¥ãªã„ã‹ãªã¨æ€ã„ã€Apple Script ã«ãŸã©ã‚Šç€ã„ãŸã®ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã¿ã¾ã—ãŸã€‚
æœ€åˆã¯ vim ã‚’ä½¿ã£ã¦ã„æ›¸ã„ã¦ã„ã¾ã—ãŸãŒã€æ—¥æœ¬èªãŒä¸Šæ‰‹ãæ‰±ãˆãšãŠãã‚‰ããƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å…¥ã£ã¦ã„ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¨ãƒ‡ã‚£ã‚¿.app ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚

# 1. ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã‚’é–‹ã

`tell application "hoge"`ã§é–‹ã‘ã‚‹ã‚ˆã†ã§ã™ãŒã€ã“ã® `hoge` éƒ¨åˆ†ã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ãã€`ãƒ•ã‚¡ã‚¤ãƒ«`ã‹ã‚‰`ç”¨èªèª¬æ˜ã‚’é–‹ã` ã‚’é¸æŠã— ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒè¨­å®š.app ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ `System Preferences.sdef` ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒå‡ºã¦ãã¾ã™ã€‚
ã“ã®.sdef ã®åå‰ã‚’å…¥ã‚Œã‚‹ã¨ã„ã„ã¿ãŸã„ã§ã™ã€‚  
è©¦ã—ã« Music.app ã®æ–¹ã‚‚åŒã˜ã‚ˆã†ã«ã‚„ã£ãŸã‚‰è¡¨ç¤ºã§ãã¾ã—ãŸã€‚  
ã‚‚ã—æ­£ç¢ºã§ãªã‹ã£ãŸã‚‰æ•™ãˆã¦æ¬²ã—ã„ã§ã™â€¦

```applescript
tell application "System Preferences"
	activate
end tell
```

activate ã¾ã§å…¥ã‚Œã‚‹ã“ã¨ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ã„ã¦è¡¨ç¤ºã§ãã‚‹ã¿ãŸã„ã§ã™ã­ã€‚  
å‰å¾Œã®å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§çµ‚ã‚ã£ãŸã‚‰æ¶ˆã™ã¿ãŸã„ãªã“ã¨ã‚‚ã§ãã‚‹ã¿ãŸã„ã§ã™ã€‚

```applescript
set didRunSystemPreferences to get running of application "System Preferences"

tell application "System Preferences"
	activate
end tell

if not didRunSystemPreferences then
	quit application "System Preferences"
end if
```

# 2. ä¸€èˆ¬ã®ãƒšãƒ¼ã‚¸(?)ã«ç§»å‹•ã™ã‚‹

ã“ã“ã®ãƒšãƒ¼ã‚¸(?)ã«ç§»å‹•ã™ã‚‹ã«ã¯ `set current pane to pane "pane id"` ã¨ã„ã†æ§‹æ–‡ã‚’ä½¿ã†ã‚ˆã†ãªã®ã§ã™ãŒã€ã“ã“ã§ `pane id` ãŒãªã«ã‹ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã“ã§ã‚„ã¯ã‚Šæœ€é€Ÿã® print debug ã‚’ä½¿ã„ã¾ã™ã€‚

```applescript
set didRunSystemPreferences to get running of application "System Preferences"

tell application "System Preferences"
	log id of every pane as list
end tell

if not didRunSystemPreferences then
	quit application "System Preferences"
end if

-- çµæœ(é•·ã„)
-- (*com.apple.preferences.AppleIDPrefPane, com.apple.preferences.Bluetooth, com.apple.preference.dock, com.apple.preference.expose, com.apple.preference.sidecar, com.apple.preference.speech, com.apple.preference.spotlight, com.apple.prefs.backup, com.apple.preference.universalaccess, com.apple.preferences.internetaccounts, com.apple.preference.keyboard, com.apple.preference.sound, com.apple.preference.screentime, com.apple.preference.security, com.apple.preferences.softwareupdate, com.apple.preference.displays, com.apple.preference.desktopscreeneffect, com.apple.preference.trackpad, com.apple.preference.network, com.apple.preferences.FamilySharingPrefPane, com.apple.preference.printfax, com.apple.preferences.configurationprofiles, com.apple.preference.mouse, com.apple.preferences.users, com.apple.preference.general, com.apple.preferences.extensions, com.apple.preference.startupdisk, com.apple.preferences.sharing, com.apple.Localization, com.apple.preference.energysaver, com.apple.preference.notifications, com.apple.preference.datetime*)
```

ãªã‚“ã‹ä¸€è¦§ã«è¼‰ã£ã¦ã‚‹å¥´ã‚‰ãŒå¯¾å¿œã—ã¦ã„ã‚‹é›°å›²æ°—ãŒã‚ã‚‹ã®ã§ 1 ã¤ãšã¤è¦‹ã¦ã„ãã¨ã€ `com.apple.preference.general` ã¨ãã‚Œã£ã½ã„ã‚‚ã®ãŒã‚ã‚‹ã®ã§ã“ã‚Œã«ç§»å‹•ã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚
çµ‚äº†ã•ã‚Œã‚‹ã¨ç¢ºèªã—ã¥ã‚‰ã„ã®ã§ã€èµ·å‹•ã™ã‚‹éƒ¨åˆ†ã ã‘ã‚’ä¸€æ—¦ä½¿ã„ã¾ã™ã€‚
ã“ã‚Œã§ä¸€èˆ¬ã®ãƒšãƒ¼ã‚¸ã«ã„ã‘ã¾ã—ãŸã€‚

```applescript
tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
end tell
```

# 3. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® Web ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å¤‰æ›´ã™ã‚‹

ã“ã“ã¾ã§æ¥ãŸã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ Web ãƒ–ãƒ©ã‚¦ã‚¶ã®éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠã—ã¦çµ‚ã‚ã‚Œã° `ï¾–ï½¼ï½¯` ã§ã™ã­ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® Web ãƒ–ãƒ©ã‚¦ã‚¶ã®éƒ¨åˆ†ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚ã’ã‚Œã°ã‚ˆã•ãã†ã§ã™ãŒã€ä½•ã‚’æŒ‡å®šã—ã¦ã‚ã’ã‚Œã°ã„ã„ã‹èª¿ã¹ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  
ã‚„ã¯ã‚Šã“ã“ã‚‚ print debugã€‚  
ã¾ãšã“ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒã©ã“ã«ã‚ã‚‹ã®ã‹ã‚’æ¢ã—ã¾ã™ã€‚  
window ã‚’æŒ‡å®šã§ãã‚‹ã¨ã„ã„ã¿ãŸã„ãªã®ã§ã™ãŒã€ãã® window åã‚’å–å¾—ã—ã¦ã¿ã¾ã™ã€‚

```applescript
tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
	tell application "System Events" to tell application process "System Preferences"
		log every UI element as list
	end tell
end tell

-- çµæœ
-- (*window ä¸€èˆ¬ of application process System Preferences, menu bar 1 of application process System Preferences*)
```

çµæœã‚’è¦‹ã‚‹ã¨ `window "ä¸€èˆ¬" of application process "System Preferences"` ã¨ã„ã†ã‚‚ã®ã®ä¸­ã«ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚  
ã•ã‚‰ã«ã“ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚‚ print debug ã§å‡ºã—ã¦ã¿ã¾ã™ã€‚

```applescript
tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
	tell application "System Events" to tell window "ä¸€èˆ¬" of application process "System Preferences"
		log every UI element as list
	end tell
end tell

-- çµæœ
-- ä¸Šã‹ã‚‰é †ç•ªã«è¼‰ã£ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§é–¢ä¿‚ã‚ã‚Šãã†ãªã¨ã“ã‚ã‚’æŠœç²‹ã™ã‚‹ã¨ã“ã†ãªã‚Šã¾ã—ãŸã€‚
-- static text ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®Webãƒ–ãƒ©ã‚¦ã‚¶: of window ä¸€èˆ¬ of application process System Preferences, pop up button 3 of window ä¸€èˆ¬ of application process System Preferences, static text ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®è¡¨ç¤º: of window ä¸€èˆ¬ of application process System Preferences
--
```

çµæœã‹ã‚‰ã¿ã‚‹ã¨ `pop up button 3 of window ä¸€èˆ¬ of application process System Preferences` ãŒå¯¾è±¡ã®ã‚ˆã†ã§ã™ã€‚
ã“ã‚Œã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚Œã°ã„ã„ã®ã§ã™ãŒã€ãã‚Œã§ã¯é¸æŠã•ã‚Œãªã„ã®ã§ã•ã‚‰ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é …ç›®ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  
ãã®å¯¾è±¡ã‚‚ã‚„ã¯ã‚Š print(ry

```applescript
tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
	tell application "System Events" to tell window "ä¸€èˆ¬" of application process "System Preferences"
		click pop up button 3
		tell pop up button 3
			log every UI element as list
			-- ã“ã“ã§ `menu 1` ã¨ã„ã†è¦ç´ ãŒå­˜åœ¨ã™ã‚‹ã®ãŒã‚ã‹ã‚‹
			log every UI element of menu 1 as list
			-- ã“ã“ã§Google Chrome.appã‚„Safari.appãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹
		end tell
	end tell
end tell
```

ã‚³ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ãŸã‚ˆã†ã« debug ã®çµæœ Google Chrome.app ã‚„ã‚‰ã‚’ click ã—ã¦ã‚ã’ã‚Œã°è‰¯ã„ã¿ãŸã„ã§ã™ã€‚  
ãªã®ã§ã“ã‚Œã‚’ã‚‚ã¨ã« Google Chrome.app ã‚’é¸æŠã™ã‚‹ã«ã¯ä¸‹ã®ã‚ˆã†ãª Script ã«ãªã‚Šã¾ã—ãŸã€‚

```applescript
tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
	tell application "System Events" to tell window "ä¸€èˆ¬" of application process "System Preferences"
		click pop up button 3
		tell pop up button 3
			click menu item "Google Chrome.app" of menu 1
		end tell
	end tell
end tell
```

# 4. å®Œæˆ

ã“ã‚Œã‚’å…ƒã«èµ·å‹•ã—ã¦ã„ãªã„ã¨ãã¯çµ‚äº†ã—ã¦ã‚‚ã‚‰ã†ã®ã‚‚è¿½åŠ ã™ã‚‹ã¨æœ€çµ‚å½¢ã¯ã“ã†ãªã‚Šã¾ã—ãŸã€‚  
script ã« chmod +x ã—ã¤ã¤ã€Google Chrome.app ã®éƒ¨åˆ†ã‚’é©å½“ãªå€¤ã«å¤‰æ›´ã™ã‚Œã°åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã«å¤‰æ›´ã‚‚ã§ãã‚‹ã§ã—ã‚‡ã†ã€‚

```applescript
#!/usr/bin/env osascript

set didRunSystemPreferences to get running of application "System Preferences"

tell application "System Preferences"
	set current pane to pane "com.apple.preference.general"
	tell application "System Events" to tell window "ä¸€èˆ¬" of application process "System Preferences"
		click pop up button 3
		tell pop up button 3
			click menu item "Google Chrome.app" of menu 1
		end tell
	end tell
end tell

if not didRunSystemPreferences then
	quit application "System Preferences"
end if
```

# æ„Ÿæƒ³

- Apple Script å®Œå…¨ã«ç†è§£ã—ãŸ()
- ãƒ–ãƒ©ã‚¦ã‚¶åˆ¥ã«å›ºå®šã™ã‚Œã°ãˆãˆã‚„ã‚“()
- ãªã‚“ã‹ Apple Script ã¡ã‚‡ã£ã¨ã‚ã‹ã£ãŸã®ã§ã¾ã‚ã„ã„ã‹

# å‚è€ƒ

- https://qiita.com/satosystems/items/8fff5b2313ecd6f81af3
- https://www.tantan-biyori.info/blog/2019/05/applescript-popup.html
